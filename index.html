<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Элина & Чингиз</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Inter:wght@300;400;500&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --gold: #c9ab81;
        --dark: #1f1f1f;
        --grey: rgb(64, 64, 64);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      html,
      body {
        height: 100%;
        min-height: 100%;
      }
      body {
        font-family: "Inter", sans-serif;
        color: white;
        background: black;
        overflow-x: hidden;
      }

      /* =========================
   PARALLAX BACKGROUND
========================= */
      .parallax-bg {
        position: fixed;
        inset: 0;
        overflow: hidden; /* обрезаем всё, что выходит за пределы */
        z-index: -2;
      }

      .parallax-inner {
        position: absolute;
        top: -20vh; /* немного смещаем вверх, чтобы скрыть верхний край */
        left: 0;
        width: 100%;
        height: 140vh; /* высота с запасом – фон никогда не обнажит дно */
        background-image: url("https://img.freepik.com/premium-vector/greenery-wedding-invitation-design-with-floral-watercolor_118960-4626.jpg?w=2000");
        background-repeat: no-repeat;
        background-position: center center;
        background-size: cover;
        will-change: transform; /* оптимизация для анимации */
      }

      /* затемнение */
      .parallax-bg::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.7));
        pointer-events: none;
        z-index: 1; /* поверх фона, но под контентом */
      }

      /* GRAIN */
      body::after {
        content: "";
        position: fixed;
        inset: 0;
        pointer-events: none;
        background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4'/%3E%3C/filter%3E%3Crect width='200' height='200' filter='url(%23n)' opacity='0.035'/%3E%3C/svg%3E");
        z-index: 999;
      }

      /* TYPO */
      h1 {
        font-family: "Playfair Display", serif;
        font-weight: 600;
        color: white;
      }
      h2,
      h3 {
        font-weight: 400;
        color: var(--grey);
      }

      section {
        max-width: 1100px;
        margin: 0 auto;
        padding: 120px 20px;
      }

      /* FADE */
      .fade {
        opacity: 0;
        height: auto;
        transform: translateY(60px);
        transition: all 1.3s ease;
      }
      .fade.show {
        opacity: 1;
        transform: translateY(0);
      }

      /* HERO */
      .hero {
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
      }

      .hero h1 {
        font-size: clamp(42px, 7vw, 82px);
        letter-spacing: 2px;
      }

      .hero p {
        margin-top: 10px;
        letter-spacing: 5px;
        text-transform: uppercase;
        opacity: 0.85;
      }

      /* GOLD LINE */
      .gold-line {
        width: 160px;
        height: 2px;
        background: linear-gradient(
          90deg,
          transparent,
          var(--gold),
          transparent
        );
        margin: 30px auto;
      }

      /* GLASS */
      .glass {
        background: rgba(255, 255, 255, 0.88);
        backdrop-filter: blur(10px);
        border-radius: 28px;
        padding: 50px;
        color: var(--grey);
        box-shadow: 0 40px 100px rgba(0, 0, 0, 0.35);
      }
      .glass.glass-form {
        padding: 10px;
      }

      /* CALENDAR */
      .calendar {
        display: inline-block;
        padding: 40px 55px;
        border: 2px solid var(--gold);
        border-radius: 26px;
        text-align: center;
      }
      .calendar .month,
      .calendar .year {
        font-size: 22px;
        letter-spacing: 3px;
      }
      .calendar .day {
        font-size: 88px;
        font-family: "Playfair Display", serif;
        font-weight: 700;
        color: var(--gold);
        line-height: 1;
        margin: 10px 0;
      }

      /* PROGRAM */
      .program li {
        list-style: none;
        padding: 18px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.15);
        font-size: 18px;
      }

      /* LOCATION */
      .location {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
        align-items: center;
      }

      .location img {
        width: 100%;
        border-radius: 22px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.35);
      }

      /* FORM */
      .form-wrapper iframe {
        width: 100%;
        height: auto;
        border: none;
      }

      footer {
        text-align: center;
        padding: 80px 20px;
        /* opacity: 0.6; */
        font-size: 28px;
      }

      @media (max-width: 900px) {
        section {
          padding: 90px 16px;
        }
        .location {
          grid-template-columns: 1fr;
        }
      }

      .rsvp-card {
        max-width: 520px;
        margin: 0 auto;
        padding: 50px 0;
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(20px);
        border-radius: 28px;
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.12);
        animation: fadeUp 1s ease;
      }

      .rsvp-title {
        text-align: center;
        font-size: 28px;
        margin-bottom: 10px;
        font-weight: 400;
        color: black;
      }

      .rsvp-sub {
        text-align: center;
        font-size: 15px;
        color: #777;
        margin-bottom: 35px;
      }
      .rsvp-somebody {
        text-align: left;
        font-size: 15px;
        color: #000000;
        margin: 15px 0 5px;
      }

      .radio-group {
        display: flex;
        gap: 15px;
        margin-top: 15px;
      }

      .radio-option {
        flex: 1;
        position: relative;
      }

      .radio-option input {
        display: none;
      }

      .radio-box {
        padding: 16px;
        border-radius: 16px;
        border: 1.5px solid #777;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        color: black;
      }

      .radio-option input:checked + .radio-box {
        background-color: rgb(177, 197, 163);
      }

      .input-modern {
        width: 100%;
        padding: 16px;
        margin-top: 20px;
        border-radius: 14px;
        border: 1.5px solid #e5e5e5;
        font-size: 15px;
        transition: all 0.3s ease;
        background: white;
      }

      .input-modern:focus {
        outline: none;
        border-color: #c9ab81;
        box-shadow: 0 0 0 4px rgba(201, 171, 129, 0.15);
      }

      .save-btn-modern {
        width: 100%;
        margin-top: 30px;
        padding: 16px;
        border-radius: 16px;
        border: none;
        font-size: 15px;
        letter-spacing: 1px;
        cursor: pointer;
        background: linear-gradient(135deg, #c9ab81, #b89365);
        color: white;
        transition: all 0.3s ease;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }
      .btn-loader {
        width: 18px;
        height: 18px;
        border: 2px solid rgba(255, 255, 255, 0.4);
        border-top: 2px solid white;
        border-radius: 50%;
        animation: spin 0.7s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .save-btn-modern:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
      }

      .status-text {
        text-align: center;
        margin-top: 18px;
        font-size: 14px;
        color: #4caf50;
        opacity: 0;
        transition: opacity 0.4s ease;
      }

      .status-text.show {
        opacity: 1;
      }

      @keyframes fadeUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (max-width: 600px) {
        .rsvp-card {
          padding: 35px 0;
        }
        .glass {
          padding: 50px 20px;
        }
      }

      .calendar-strip {
        display: flex;
        justify-content: center;
        gap: 18px;
        max-width: 720px;
        margin: 0 auto;
      }

      .calendar-day {
        flex: 1 1 0;
        min-width: 0; /* ВАЖНО — убирает растяжение */
        text-align: center;
        padding: 28px 12px;
        border-radius: 22px;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(6px);
        position: relative;
      }

      .weekday {
        font-size: 13px; /* было больше */
        letter-spacing: 0.8px; /* уменьшаем */
        text-transform: uppercase;
        color: var(--gold);
        margin-bottom: 8px;
        line-height: 1.2;

        white-space: normal; /* разрешаем перенос */
        word-break: break-word; /* переносит длинные слова */
        min-height: 32px; /* стабилизирует высоту */
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .month {
        font-size: 14px;
        color: #888;
        margin-bottom: 10px;
      }

      .date {
        font-size: 48px;
        font-family: "Playfair Display", serif;
        color: var(--dark);
      }
      .calendar-day.active {
        background: white;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
        overflow: visible;
      }

      .ring-wrapper {
        position: absolute;
        inset: -18px;
        pointer-events: none;
      }

      .ring {
        width: 100%;
        height: 100%;
      }

      .ring-path {
        fill: none;
        stroke: var(--gold);
        stroke-width: 3;
        stroke-linecap: round;
        stroke-dasharray: 600;
        stroke-dashoffset: 600;
        animation: drawRing 1.8s ease forwards;
      }
      .countdown {
        margin-top: 30px;
        font-size: 20px;
        color: var(--dark);
      }

      @keyframes drawRing {
        to {
          stroke-dashoffset: 0;
        }
      }

      @media (max-width: 600px) {
        .countdown {
          font-size: 14px;
        }
        .calendar-strip {
          gap: 8px;
        }

        .calendar-day {
          padding: 20px 6px;
        }

        .date {
          font-size: 32px;
        }
        .weekday {
          font-size: 11px;
          letter-spacing: 0.5px;
        }
      }
    </style>
  </head>
  <!-- FIREBASE -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import {
      getFirestore,
      doc,
      getDoc,
      setDoc,
      serverTimestamp,
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDCcOYnGQksJUe6P-kKlUEOtmsIXdBwH4E",
      authDomain: "wedding-invite-51714.firebaseapp.com",
      projectId: "wedding-invite-51714",
      storageBucket: "wedding-invite-51714.firebasestorage.app",
      messagingSenderId: "881433018362",
      appId: "1:881433018362:web:5c573164a8ea308004ee43",
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Получаем ID гостя из URL
    const params = new URLSearchParams(window.location.search);
    const guestId = params.get("guest");

    if (!guestId) {
      document.getElementById("rsvp-section").innerHTML =
        "<h3 style='text-align:center'>Ошибка: отсутствует персональная ссылка.</h3>";
    } else {
      loadGuest();
    }
    async function loadGuest() {
      const ref = doc(db, "guests", guestId);
      const snap = await getDoc(ref);

      if (snap.exists()) {
        const data = snap.data();
        if (data.updatedAt) {
          document.getElementById("formContent").style.display = "none";
          document.getElementById("successContent").style.display = "block";
        }
        document.getElementById("firstName").value = data.firstName || "";
        document.getElementById("lastName").value = data.lastName || "";
        document.getElementById("phone").value = data.phone || "";

        if (data.withSomeone) {
          document.getElementById("yes").checked = true;
          document.getElementById("companion-block").style.display = "block";
          document.getElementById("companionName").value =
            data.companionName || "";
        } else if (data.withSomeone === false) {
          document.getElementById("no").checked = true;
        }
      }
    }

    document.getElementById("yes").addEventListener("change", () => {
      document.getElementById("companion-block").style.display = "block";
    });

    document.getElementById("no").addEventListener("change", () => {
      document.getElementById("companion-block").style.display = "none";
    });

    document.getElementById("saveBtn").addEventListener("click", async () => {
      const firstName = document.getElementById("firstName").value.trim();
      const lastName = document.getElementById("lastName").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const withSomeone = document.getElementById("yes").checked;
      const noSelected = document.getElementById("no").checked;
      const companionName = document
        .getElementById("companionName")
        .value.trim();

      // Валидация
      if (!firstName || !lastName || !phone) {
        alert("Пожалуйста, заполните все обязательные поля.");
        return;
      }

      if (!withSomeone && !noSelected) {
        alert("Пожалуйста, выберите вариант ответа.");
        return;
      }

      if (withSomeone && !companionName) {
        alert("ФИО того, с кем придете.");
        return;
      }

      // Простая проверка телефона
      const phoneRegex = /^[0-9+\-\s()]{6,20}$/;
      if (!phoneRegex.test(phone)) {
        alert("Введите корректный номер телефона.");
        return;
      }
      const btn = document.getElementById("saveBtn");
      const btnText = document.getElementById("btnText");
      const btnLoader = document.getElementById("btnLoader");

      // блокируем кнопку
      btn.disabled = true;
      btnText.style.display = "none";
      btnLoader.style.display = "inline-block";
      await setDoc(doc(db, "guests", guestId), {
        firstName,
        lastName,
        phone,
        withSomeone,
        companionName: withSomeone ? companionName : "",
        updatedAt: serverTimestamp(),
      });
      btn.disabled = false;
      btnText.style.display = "inline";
      btnLoader.style.display = "none";
      document.getElementById("formContent").style.display = "none";
      document.getElementById("successContent").style.display = "block";
    });
    document.getElementById("editBtn").addEventListener("click", () => {
      document.getElementById("successContent").style.display = "none";
      document.getElementById("formContent").style.display = "block";
    });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const weddingDate = new Date("2026-07-04T16:00:00");

      const weekdays = [
        "Воскресенье",
        "Понедельник",
        "Вторник",
        "Среда",
        "Четверг",
        "Пятница",
        "Суббота",
      ];

      function updateCalendar() {
        const prev = new Date(weddingDate);
        prev.setDate(prev.getDate() - 1);

        const next = new Date(weddingDate);
        next.setDate(next.getDate() + 1);

        document.getElementById("prevDate").textContent = prev.getDate();
        document.getElementById("mainDate").textContent = weddingDate.getDate();
        document.getElementById("nextDate").textContent = next.getDate();

        document.getElementById("prevWeekday").textContent =
          weekdays[prev.getDay()];
        document.getElementById("mainWeekday").textContent =
          weekdays[weddingDate.getDay()];
        document.getElementById("nextWeekday").textContent =
          weekdays[next.getDay()];
      }

      function updateCountdown() {
        const now = new Date();
        const diff = weddingDate - now;

        if (diff <= 0) {
          document.getElementById("countdown").textContent =
            "Сегодня наш день ❤️";
          return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor(
          (diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60),
        );

        document.getElementById("countdown").textContent =
          `До свадьбы осталось ${days} дней и ${hours} часов`;
      }

      updateCalendar();
      updateCountdown();
      setInterval(updateCountdown, 60000);
    });
  </script>
  <script src="https://forms.yandex.ru/_static/embed.js"></script>
  <body>
    <div class="parallax-bg" id="parallax">
      <div class="parallax-inner" id="parallaxInner"></div>
    </div>

    <section class="hero fade">
      <div>
        <h1>Элина & Чингиз</h1>
        <div class="gold-line"></div>
        <p>4 июля 2026</p>
      </div>
    </section>

    <section class="fade">
      <div class="glass" style="text-align: center">
        <h2>Дата нашего дня</h2>
        <div class="gold-line"></div>
        <div class="calendar-strip">
          <div class="calendar-day" id="prevDay">
            <div class="weekday" id="prevWeekday"></div>
            <div class="month">июля</div>
            <div class="date" id="prevDate"></div>
          </div>

          <div class="calendar-day active" style="z-index: 10">
            <div class="ring-wrapper">
              <svg viewBox="0 0 200 200" class="ring">
                <ellipse cx="100" cy="100" rx="90" ry="100" class="ring-path" />
              </svg>
            </div>

            <div class="weekday" id="mainWeekday"></div>
            <div class="month">июля</div>
            <div class="date" id="mainDate"></div>
          </div>

          <div class="calendar-day" id="nextDay">
            <div class="weekday" id="nextWeekday"></div>
            <div class="month">июля</div>
            <div class="date" id="nextDate"></div>
          </div>
        </div>

        <div class="countdown" id="countdown"></div>
      </div>
    </section>

    <section class="fade">
      <div class="glass">
        <h2 style="text-align: center">Программа дня</h2>
        <div class="gold-line"></div>
        <ul class="program">
          <li>15:00 — Сбор гостей</li>
          <li>16:00 — Церемония</li>
          <li>17:00 — Фото и аперитив</li>
          <li>17:10 — Фотка с Диманом и Ирой</li>
          <li>18:30 — Банкет</li>
        </ul>
      </div>
    </section>

    <section class="fade">
      <div class="glass">
        <h2 style="text-align: center">Место проведения</h2>
        <div class="gold-line"></div>

        <div class="location">
          <img
            src="https://buyingbusinesstravel.com.ru/upload/medialibrary/f04/ixfld41v7d6ns81lhg2ozlh96syue8qr.jpg"
            alt="Место проведения"
          />

          <div>
            <h3 style="padding-bottom: 20px">Лакшери коллекшн рэдисон</h3>
            <p>
              Уютная площадка с невероятным люксом, светом и пространством для
              праздника
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="fade">
      <div class="rsvp-card" id="rsvp-section">
        <div class="rsvp-title">Подтверждение присутствия</div>
        <iframe
          src="https://docs.google.com/forms/d/e/1FAIpQLSemB8X_gfYfUSeONNIgKcI6ksC4CQaQ74gcuJgFltSvPQKGGA/viewform?embedded=true"
          width="100%"
          height="auto"
          frameborder="0"
          marginheight="0"
          marginwidth="0"
          >Загрузка…</iframe
        >
      </div>
    </section>

    <footer>
      С любовью, Элина и Чингиз <span style="color: #ff3636">&#10084;</span>
    </footer>

    <script>
      window.addEventListener("scroll", () => {
        const scroll = window.pageYOffset;
        const inner = document.getElementById("parallaxInner");
        // Коэффициент 0.05 даёт медленное движение – фон «отстаёт» от скролла
        inner.style.transform = `translateY(${-scroll * 0.05}px)`;
      });

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((e) => {
            if (e.isIntersecting) e.target.classList.add("show");
          });
        },
        { threshold: 0.2 },
      );

      document.querySelectorAll(".fade").forEach((el) => observer.observe(el));
    </script>
  </body>
  
</html>
